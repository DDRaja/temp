SELECT 'LAST LOG APPLIED : ' LOGS, TO_CHAR(NEXT_TIME,'DD-MON-YY:HH24:MI:SS') TIME FROM V$ARCHIVED_LOG WHERE SEQUENCE# = (SELECT MAX(SEQUENCE#) FROM V$ARCHIVED_LOG WHERE APPLIED='YES') UNION SELECT 'LAST LOG RECEIVED : ' LOGS, TO_CHAR(NEXT_TIME,'DD-MON-YY:HH24:MI:SS') TIME FROM V$ARCHIVED_LOG WHERE SEQUENCE# = (SELECT MAX(SEQUENCE#) FROM V$ARCHIVED_LOG);

SELECT ARCH.THREAD# "Thread", ARCH.SEQUENCE# "Last Sequence Received", APPL.SEQUENCE# "Last Sequence Applied", (ARCH.SEQUENCE# - APPL.SEQUENCE#) "Difference" FROM (SELECT THREAD# ,SEQUENCE# FROM V$ARCHIVED_LOG WHERE (THREAD#,FIRST_TIME ) IN (SELECT THREAD#,MAX(FIRST_TIME) FROM V$ARCHIVED_LOG GROUP BY THREAD#)) ARCH,(SELECT THREAD# ,SEQUENCE# FROM V$LOG_HISTORY WHERE (THREAD#,FIRST_TIME ) IN (SELECT THREAD#,MAX(FIRST_TIME) FROM V$LOG_HISTORY GROUP BY THREAD#)) APPL WHERE ARCH.THREAD# = APPL.THREAD# ORDER BY 1;


set numwidth 16
select min(scn) from (
select to_number(min(fhscn)) scn from x$kcvfh
union
select to_number(min(checkpoint_change#)) scn from v$datafile
union
select to_number(current_scn) scn from v$database
);

        MIN(SCN)
----------------
15383183204793
15383183204793

Script
run
{
allocate channel t1 device type disk;
allocate channel t2 device type disk;
allocate channel t3 device type disk;
allocate channel t4 device type disk;
allocate channel t5 device type disk;
allocate channel t6 device type disk;
allocate channel t7 device type disk;
allocate channel t8 device type disk;
BACKUP INCREMENTAL FROM SCN 15379623664346 DATABASE FORMAT '/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_%U.bkp';
backup current controlfile for standby  format '/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_CNCTL_%U.bkp';
release channel t8;
release channel t7;
release channel t6;
release channel t5;
release channel t4;
release channel t3;
release channel t2;
release channel t1;
}

-rw-r-----   1 oracle     dba        2792644608 Jun 17 14:47 ICOSTP_INC_o3109mv8_1_1.bkp
-rw-r-----   1 oracle     dba        6791528448 Jun 17 14:47 ICOSTP_INC_ns109mv6_1_1.bkp
-rw-r-----   1 oracle     dba        3458760704 Jun 17 14:47 ICOSTP_INC_nu109mv7_1_1.bkp
-rw-r-----   1 oracle     dba        5037334528 Jun 17 14:48 ICOSTP_INC_o0109mv7_1_1.bkp
-rw-r-----   1 oracle     dba        4394196992 Jun 17 14:48 ICOSTP_INC_nt109mv6_1_1.bkp
-rw-r-----   1 oracle     dba        2502836224 Jun 17 14:48 ICOSTP_INC_o2109mv7_1_1.bkp
-rw-r-----   1 oracle     dba        8787304448 Jun 17 14:48 ICOSTP_INC_nv109mv7_1_1.bkp
-rw-r-----   1 oracle     dba        7281418240 Jun 17 14:48 ICOSTP_INC_o1109mv7_1_1.bkp
-rw-r-----   1 oracle     dba        229244928 Jun 17 14:48 ICOSTP_INC_o4109n6a_1_1.bkp
-rw-r-----   1 oracle     dba        229244928 Jun 17 14:49 ICOSTP_SBY_CONTROL.bkp
-rw-------   1 oracle     dba         154461 Jun 17 14:50 nohup.out
g4u2701c:ICOSTP/backup $ pwd
/u01/app/oracle/arch/ICOSTP/backup




Copy backup files to conversion server
stty erase ^?
stty susp ^Z
screen -S scp0605


p1ug15207
nohup scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_nv109mv7_1_1.bkp /SFS_PRD/UST/icostp_incr/. > scp1.out  2>&1  
nohup scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_o3109mv8_1_1.bkp /SFS_PRD/UST/icostp_incr/. > scp2.out  2>&1  

p1ug15206
nohup scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_o1109mv7_1_1.bkp  /SFS_PRD/UST/icostp_incr/. > scp3.out  2>&1  
nohup scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_nu109mv7_1_1.bkp  /SFS_PRD/UST/icostp_incr/. > scp4.out  2>&1

p1ug15210
nohup scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_ns109mv6_1_1.bkp /SFS_PRD/UST/icostp_incr/. > scp5.out  2>&1  
nohup scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_o2109mv7_1_1.bkp  /SFS_PRD/UST/icostp_incr/. > scp6.out  2>&1

p1ug15211
nohup scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_o0109mv7_1_1.bkp /SFS/UST/icostp_incr/. > scp7.out  2>&1  
nohup scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_nt109mv6_1_1.bkp  /SFS/UST/icostp_incr/. > scp8.out  2>&1 

scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_INC_o4109n6a_1_1.bkp /SFS_PRD/UST/icostp_incr/.

scp -C dasaradh@g4u2701c.houston.hpecorp.net:/u01/app/oracle/arch/ICOSTP/backup/ICOSTP_SBY_CONTROL.bkp /SFS_PRD/UST/icostp_incr/


Cancel MRP
alter database recover managed standby database cancel;
SELECT PROCESS, STATUS, THREAD#, SEQUENCE#, BLOCK#, BLOCKS FROM V$MANAGED_STANDBY;

Shutdown DB
Startup nomount

# Restore standby controlfile from '////'
> run {
     allocate channel ch1 device type disk;
     allocate channel ch2 device type disk;
     restore standby controlfile from '/SFS_PRD/UST/icostp_incr/ICOSTP_SBY_CONTROL.bkp';
  }


#mount the database
sql 'alter database mount';

# catalog start with
run {
     allocate channel ch1 device type disk;
     allocate channel ch2 device type disk;
     catalog start with '/SFS_PRD/UST/icostp_incr/';
  }
  
# recover database
cat icost_inc.rmn
run {
allocate channel c1 device type disk;
allocate channel c2 device type disk;
allocate channel c3 device type disk;
allocate channel c4 device type disk;
allocate channel c5 device type disk;
allocate channel c6 device type disk;
allocate channel c7 device type disk;
allocate channel c8 device type disk;
recover database noredo;
release channel c1;
release channel c2;
release channel c3;
release channel c4;
release channel c5;
release channel c6;
release channel c7;
release channel c8;
}

#Check the v$datafile
select name from v$datafile;

#If any new files added in Source after backup follow Doc ID 8417565.1  -- If not ignore this step

#Clear redo logfiles
alter database clear logfile group 1;
alter database clear logfile group 2;
alter database clear logfile group 3;
alter database clear logfile group 4;
alter database clear logfile group 5;
alter database clear logfile group 6;
alter database clear logfile group 7;
alter database clear logfile group 8;
alter database clear logfile group 9;
alter database clear logfile group 10;
alter database clear logfile group 11;
alter database clear logfile group 12;
alter database clear logfile group 13;
alter database clear logfile group 14;
alter database clear logfile group 15;

#start the MRP and check it is synchronized
alter database recover managed standby database disconnect from session;
SELECT PROCESS, STATUS, THREAD#, SEQUENCE#, BLOCK#, BLOCKS FROM V$MANAGED_STANDBY;



p1ug15206.dc01.its.hpecorp.net 10.87.190.115 WIPRO
p1ug15207.dc01.its.hpecorp.net 10.87.190.116 Deloitte


p1ug15208.dc01.its.hpecorp.net 10.87.190.117 Deloitte
p1ug15209.dc01.its.hpecorp.net 10.87.190.118 HPE
p1ug15210.dc01.its.hpecorp.net 10.87.190.119 Infosys
p1ug15211.dc01.its.hpecorp.net 10.87.190.120 Deloitte
p1ug15212.dc01.its.hpecorp.net 10.87.190.121 TCS